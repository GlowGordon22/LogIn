<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Form</title>
    <link rel="stylesheet" href="styles.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
    <div class="wrapper">
        <form action="">
            <h1>Login</h1>
            <div class="input-box">
                <input type="text" id="colleagueId" placeholder="Colleague ID" required>
                <i class='bx bxs-user'></i>
            </div>
            <div class="input-box">
                <input type="password" id="staffPin" placeholder="Staff Pin" required>
                <i class='bx bxs-lock-alt'></i>
            </div>
            <button type="submit" class="btn" onclick="checkLogin(event)">Login</button>
            <div class="register-link">
                <p>Need to make another staff account? <a href="#" onclick="adminRegister()">Admin Register</a></p>
            </div>
        </form>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>

    <script>
        // Initialize Firebase with your Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyAA6MF6HD9upyKY7PoFuk7ltMDH00-sANM",
            authDomain: "login-system-storage.firebaseapp.com",
            databaseURL: "https://login-system-storage-default-rtdb.firebaseio.com",
            projectId: "login-system-storage",
            storageBucket: "login-system-storage.firebasestorage.app",
            messagingSenderId: "423360771345",
            appId: "1:423360771345:web:7b1fcb8208e98e301c88b0",
            measurementId: "G-9FDNSQQ2Z5"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database(app);

        // Check login credentials
        function checkLogin(event) {
            event.preventDefault();  // Prevent the form from submitting

            const colleagueId = document.getElementById('colleagueId').value;
            const staffPin = document.getElementById('staffPin').value;

            // Retrieve the account data from Firebase
            const ref = database.ref('accounts/' + colleagueId);
            ref.once('value', function(snapshot) {
                const data = snapshot.val();
                if (data && data.staffPin === staffPin) {
                    alert('Login successful!');
                    // Redirect to another page or load content (this part can be customized)
                    // Example: window.location.href = "orders.html"; 
                } else {
                    alert('Invalid Colleague ID or Staff Pin!');
                }
            });
        }

        // Admin Register functionality
        function adminRegister() {
            const adminPin = prompt('Enter Admin Pin:');
            if (adminPin === 'admin') {
                const colleagueId = prompt('Enter new Colleague ID:');
                const staffPin = prompt('Enter new Staff Pin:');

                if (colleagueId && staffPin) {
                    // Save the new account to Firebase
                    const ref = database.ref('accounts/' + colleagueId);
                    ref.set({
                        colleagueId: colleagueId,
                        staffPin: staffPin
                    }).then(() => {
                        alert('New staff account created!');
                    }).catch((error) => {
                        alert('Error creating account: ' + error.message);
                    });
                } else {
                    alert('Colleague ID and Staff Pin cannot be empty.');
                }
            } else {
                alert('Incorrect Admin Pin.');
            }
        }
    </script>
</body>
</html>
